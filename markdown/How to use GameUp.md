# 概要
* GameUp.jsを利用できるようになる
* クソ仕様沢山あるけど許して
* 覚えてくれると開発が捗る
* 自由な実装が可能になる

分かりにくい所があれば、  
ハングアウトか何かで質問受けます。  

# 大まかな仕様
まずGameUpには2つのクラスが存在します。  
名称と説明を軽く書きます。

* **canvasEx**  
  メインクラス。描画とかを行う。  
  色々なメソッドが用意してある。  
  
* **sound**  
  audioをコントロールする。  
  正直必要ない。（けど必要でもある）
  
  重要なのはcanvasExの扱いなので、  
  重点的に説明していきます。  
  
# canvasEx の仕様  
イキナリですが、  
canvasExの使い方（基礎）です。  

canvasExを使用する際は、  
new インスタンスを使います。  
極普通のクラスを使う方法ですね。

(例)  
```
var obj = new canvasEx({...});
```  

さて、ここからが本題です。  
**仕様が面倒な上に、説明が下手**なので、  
分かりにくいかも知れません。  

---

## 本題  

まず canvasEx クラスは、  
cnvasExpert の省略です。  
canvas を高度に扱うという意味合いです。  

即ち、実装が面倒な動作も、  
canvasEx クラスを用いると、  
**比較的楽に実装できる**ということです。  

そして、何より重要なのが、  
canvasEx の引数はオブジェクトを使います。  

本来、関数の引数には、  
指定された位置に指定された引数があり、  
対応した値を代入して定義するものですが、  

canvasEx の様に、高度な設定を行う場合、  
可変長の引数である場合、順序が指定されていると、  
**非常に使いづらい物**になってしまいます。   

(例)  
```
var obj = new canvasEx(x,y,canvas,context,type,mode,...,something);
// 引数が増えるほど可読性が落ちる
```  

そのため、 canvasEx では引数を単一（input）し、  
値を**オブジェクト**として引き取っています。  
newインスタンスで生成されたcanvasExは、  
引数のオブジェクトをthisにコピーします。  

(例)  
```
var obj = new canvasEx({x: 0, y:0, type: img, ... something: null});
// 名前と紐付いて非常にわかりやすい
```  

## 実装
さて、本題で大体仕組みは理解できたと思います。  
ここから、更に深く掘り下げ、実装まで行きます。  

## 要素  
canvasEx を使う上で、必要な要素があります。  
以下の必要要素は、全てのtypeにおいて必須です。  

### 必要要素　　
* context  
→描画エリアのcontext

* x  
→描画する x 座標（絶対座標）  

* y  
→描画する y 座標（絶対座標）  

* type
→描画するモード   

* alpha  
→透明度を指定（0.0 ~ 1.0）  

* center  
→描画座標をオブジェクトの中心にする  
 `
 center: 1
 `  
 であるなら中心、それ以外は左上が座標になる。  

また、以下は全てのtypeにおいて利用可能ですが、  
使わなくても動作する要素です。  

### 任意要素（無くても動作します）  
* canvas  
→描画エリアのcontextを保持するcanvasを格納  
 x座標あるいはy座標にcenterを用いた演算を利用する場合に、  
 必要になります。
 
 (例)  
 ```
 {canvas: canvasDOM, x: center + 10, y: center + -70 ... , something}
 // canvas を指定した状態では x,y において center が利用できます。
 // center は canvas から width,height を取得して 自動計算します。
 // x: center + 10 は canvas の 中心xから 10 正に増加させた位置で、
 // y: center + -70 は canvas の 中心yから 70 負に増減させた位置です。
 ```
* label
→生成したcanvasExにlabel情報を保持させます。  
 配列でも、単体の値でも可能です。  
 そのオブジェクトが何であるかの指標になります。  
 また保持させるlabelによって、様々な動作が可能です。  

これらが、必要最低限の要素です。  
加えて、各typeごとに、  
必要要素が加わります。  

## type

次に重要な要素 **type** についてです。  
**type** にはいくつかの種類があり、  
その中から一つ選んで追加します。  

種類は以下の通りです。  
* dot  
→点を描画する  

* pol  
→正多角形を描画する  

* pth  
→頂点座標を与え描画する  

* txt  
→文字を描画する  

* img  
→画像を描画する

夫々のタイプに必要な要素と、  
使い方の例をまとめます。  

**/** で区切られているものは、  
何方でもいいものです。  

## dot  
**dot** を利用する際の利用可能要素です。  

### 必要要素
* r / radius  
→点のサイズ（半径）を指定  

* color  
→点の色を指定  

### 任意要素（無くても動作します）
* mode  
→描画モードを **stroke** / **fill**  
 のいずれかを選択します。
 **mode** が未指定、あるいは、  
 値が**stokre**でも**fill**でもない場合は、  
 描画モードは**fill**になります。  
 
* bold  
→**mode**が**stroke**の時の線の太さ  
 
## pol  
**pol** を利用する際の利用可能要素です。  

### 必要要素  
* r / radius  
→図形のサイズ（半径）を指定  

* d / direction  
→図形の角度を指定（度）  

* v / vertex  
→図形の頂点数を指定（正v角形）  

* color  
→図形の色を指定  

### 任意要素（無くても動作します）
* mode  
→描画モードを **stroke** / **fill**  
 のいずれかを選択します。  
 
* bold  
→**mode**が**stroke**の時の線の太さ  

## pth  
**pth** を利用する際の利用可能要素です。  

### 必要要素  
* pos  
→配列で頂点座標を指定。  
 各要素にはx,yを保持するオブジェクトを格納。  
 また、座標はcanvasEx本体のx,yを中心とした、  
 相対座標で指定する。  
 スクリーン上の絶対座標ではないので注意。  
 
 (例)  
 ```
 pos: [{x: 10, y: 10}, {x: 10, y: -10}, {x: -10, y: -10}, {x: -10, y: 10}]
 // canvasEx中心座標 x,y からの相対座標で指定
 ```

* color  
→図形の色を指定  

### 任意要素（無くても動作します）
* mode  
→描画モードを **stroke** / **fill**  
 のいずれかを選択します。  
 
* bold  
→**mode**が**stroke**の時の線の太さ  

## txt  
**txt** を利用する際の利用可能要素です。  

### 必要要素  
* text  
→描画する文字  

* size
→描画する文字のサイズ（%）  
 100が基準（つまり100%、Scratchのサイズと同様）  

### 任意要素（無くても動作します）
* mode  
→文字を描画する方向の指定。
 **mode**が1ならば縦書き。  
 それ以外（0や未定義）は横書き。  
 
* reverse  
→左右書きを指定。  
 1ならば文字を左から右へ反転。  
 それ以外（0や未定義）は横書き。  
 
## img  
**img** を利用する際の利用可能要素です。  

### 必要要素  
* src  
→画像のソースリンク    

### 任意要素（無くても動作します）　　
* w / width  
→画像の横サイズ  
 **canvas**と併合すると、  
 値に**fit**を用いることが可能。  
 自動計算して画面の横サイズに合わせる。  

* h / height  
→画像の縦サイズ  
 **canvas**と併合すると、  
 値に**fit**を用いることが可能。  
 自動計算して画面の縦サイズに合わせる。  
 
 (例)  
 ```
 {canvas: canvasDOM, w: fit, h: fit}
 // width,height を画面サイズにfitさせる
 ```
 
## 実例
抜けている箇所があるかも知れないが、説明は大体以上。  
ここからは、実際に使用されてるコードを元に解説を行う。  

#### (例1 - main.js, line:75)
```
  gui.push(new canvasEx({
	  canvas, context, type: img, x: 0, y: 0, w: fit, h: fit, alpha: 1,
		src: 'Image/Screen/background.png',
		label: ['Background', 'Title']
  }));
```
まず混乱しないように解説をしておくと、  
スコープ変数canvas, contextをinit関数内で定義し、  
値にはDOMを格納したcanvとcontextを取得したcontが  
夫々代入されている。  

実はJavaScriptのオブジェクトは、  
変数名をキーに利用する場合はコロンが必要ない。  

例えば  
`var x = 50;`  
50が入った変xをオブジェクトに利用する際に、  
`{x: x}`  
このように書く必要はなく、  
`{x}`  
このように表記しても動くのだ。  

canvas,contextには同じことを利用している。  
さて、ソースコードの本題を解説してみる。  

まず、コードを分割する。  

***1.***  
`canvas, context, type: img, x: 0, y: 0, w: fit, h: fit, alpha: 1,`  
まず、このコードでは**canvas, alpha, w, h**といった、  
必須ではない要素が含まれている。  本来必須で無いものは、  
**context, type, x, y**である。  

このコードでは、  
***canvas上の0,0に、w,hをfitさせ透明度1（不透明）で描画する***  
ことを示している。  
これだけだ。  
単純。  

***2.***  
そして、これらが残りの2行。
```
src: 'Image/Screen/background.png',
label: ['Background', 'Title']
```
***1.*** と同様に、要素を分けると、
#### 必要  
* src  

#### 任意  
* label  

このように要素を分けることが出来る。  
srcに指定した画像のソースを読み込ませるだけだ。  
labelのBackground, Titleについては、

* Background  
→背景であることの指標  

* Title  
→タイトル画面での描画を許可  

これらの効果が適応されている。

## まとめ  
ところどころ、分かりにくい箇所が  
あるかも知れないが、  
大体の概要はこんな所だ。  

比較的canvasの描画の扱いが、  
簡単にできるようになっている。  

冒頭でも記述したが、  
わからない箇所は質問を受け付ける。  
是非覚えてプログラミングへの協力を願いたい。  

- 以上

_**(例2)以降は、必要であれば追加する**_
